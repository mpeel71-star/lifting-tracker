<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lifting Tracker</title>
  <link rel="stylesheet" href="style.css" />

  <!-- Charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">üèãÔ∏è</div>
        <div>
          <div class="title">Lifting Tracker</div>
          <div class="subtitle" id="activeRoutineLabel"></div>
        </div>
      </div>

      <div class="actions">
        <button id="exportBtn" class="btn">Export JSON</button>
        <button id="importBtn" class="btn btn-primary">Import JSON</button>
        <input id="importFile" type="file" accept="application/json" style="display:none" />
      </div>
    </header>

    <!-- Firebase Cloud Sync -->
    <section class="card" id="firebaseAuth">
      <h2>Cloud Sync (Firebase)</h2>
      <p class="muted">
        Sign in to sync routines + workout history across devices. Local storage remains a backup.
      </p>

      <div class="row">
        <input id="fbEmail" type="email" placeholder="Email" />
        <input id="fbPassword" type="password" placeholder="Password" />
        <button id="fbCreateAccount" class="btn btn-primary">Create account</button>
        <button id="fbSignIn" class="btn">Sign in</button>
        <button id="fbSignOut" class="btn" style="display:none">Sign out</button>
      </div>

      <details class="advanced">
        <summary>Advanced</summary>
        <div class="row" style="margin-top:10px;">
          <button id="fbPush" class="btn btn-primary" style="display:none;">Push local ‚Üí cloud</button>
          <button id="fbPull" class="btn" style="display:none;">Pull cloud ‚Üí local</button>
          <button id="fbUseLocal" class="btn">Use local (overwrite in-app)</button>
        </div>
        <p class="muted tiny">
          ‚ÄúPull‚Äù replaces your local backup with cloud. ‚ÄúPush‚Äù replaces cloud with your current local data.
        </p>
      </details>

      <div id="fbMsg" class="error" style="margin-top:10px;"></div>
      <div id="fbStatus" class="success" style="margin-top:6px;"></div>
    </section>

    <!-- Tabs -->
    <nav class="tabs">
      <button class="tab active" data-tab="log">Log</button>
      <button class="tab" data-tab="routines">Routines</button>
      <button class="tab" data-tab="history">History</button>
      <button class="tab" data-tab="reports">Reports</button>
    </nav>

    <main>
      <!-- LOG -->
      <section id="tab-log" class="tabpage active">
        <div class="card">
          <h2>Start a Workout</h2>
          <div class="row">
            <label class="label">Day</label>
            <select id="daySelect"></select>

            <label class="chip">
              <input id="compoundOnly" type="checkbox" />
              Compound only
            </label>

            <button id="startWorkout" class="btn btn-primary">Start workout</button>
            <button id="clearWorkout" class="btn">Clear</button>
            <button id="saveWorkout" class="btn btn-primary">Save workout</button>
          </div>
          <p class="muted tiny">
            Exercise titles show PR: top weight + best reps at that weight. Enter a weight to see your best reps ever at that weight.
          </p>
        </div>

        <div class="card">
          <h2>Workout</h2>
          <div id="workoutArea"></div>
        </div>
      </section>

      <!-- ROUTINES -->
      <section id="tab-routines" class="tabpage">
        <div class="card">
          <h2>Routines</h2>
          <div id="routinesArea"></div>
        </div>
      </section>

      <!-- HISTORY -->
      <section id="tab-history" class="tabpage">
        <div class="card">
          <h2>History</h2>
          <div id="historyArea"></div>
        </div>
      </section>

      <!-- REPORTS -->
      <section id="tab-reports" class="tabpage">
        <div class="card">
          <h2>Reports</h2>

          <div class="row">
            <label class="chip">
              <input id="reportCompoundOnly" type="checkbox" />
              Compound only
            </label>

            <label class="label">Metric</label>
            <select id="reportMetric">
              <option value="e1rm">Estimated 1RM (best set)</option>
              <option value="topWeight">Top weight (best set)</option>
              <option value="volume">Total volume (sum weight√óreps)</option>
            </select>
          </div>

          <div class="row">
            <label class="label">Exercise</label>
            <select id="reportExercise"></select>
          </div>

          <div id="reportSummary" class="muted"></div>
          <div class="divider"></div>
          <div id="reportTable" class="list"></div>
        </div>

        <div class="card">
          <h2>Trend Chart</h2>
          <canvas id="reportChart" height="220"></canvas>
          <p class="muted tiny">Tip: chart uses your best set per workout for the selected exercise.</p>
        </div>
      </section>
    </main>

    <footer class="footer muted tiny">
      Local backup in your browser + optional Firebase cloud sync. Export JSON anytime to migrate.
    </footer>
  </div>

  <!-- IMPORTANT: type="module" is required because script.js uses import -->
  <script type="module" src="script.js"></script>
</body>
</html>
